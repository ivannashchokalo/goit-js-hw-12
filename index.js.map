{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport { perPage } from \"../main\";\n\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '53372962-e1472c27af09e15e68765cdc2';\n\nexport async function getImagesByQuery(query, page) {\n    const response = await axios.get(BASE_URL, {\n        params: {\n            key: API_KEY,\n            q: query,\n            page: page,\n            per_page: perPage,\n            image_type: 'photo',\n            orientation: 'horizontal',\n            safesearch: true,\n        }\n    });\n\n    return response.data;\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\"; \nimport { comment, list } from \"postcss\";\nimport { refs } from \"../main\";\n\n\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'alt',\n    captionDelay: 250,\n});\n\nexport function createGallery(images){\n    const markup = images.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => {\n        return `\n        <li>\n              <a href=\"${largeImageURL}\"\n                ><img src=\"${webformatURL}\" alt=\"${tags}\" />\n                <ul>\n                  <li>\n                    <h3>Likes</h3>\n                    <p>${likes}</p>\n                  </li>\n                  <li>\n                    <h3>Views</h3>\n                    <p>${views}</p>\n                  </li>\n                  <li>\n                    <h3>comments</h3>\n                    <p>${comments}</p>\n                  </li>\n                  <li>\n                    <h3>downloads</h3>\n                    <p>${downloads}</p>\n                  </li></ul\n              ></a>\n            </li>`\n    }).join('')\n\n    refs.galleryList.insertAdjacentHTML('beforeend', markup);\n\n    lightbox.refresh();\n}\n\nexport function clearGallery() {\n    refs.galleryList.innerHTML = '';\n}\n\nexport function showLoader() {\n    refs.loader.classList.remove('loader-hidden');\n}\n\nexport function hideLoader() {\n    refs.loader.classList.add('loader-hidden');\n}\n\nexport function showLoadMoreButton(){\n    refs.showMoreBtn.classList.remove('btn-hidden');\n}\n\nexport function hideLoadMoreButton(){\n   refs.showMoreBtn.classList.add('btn-hidden'); \n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getImagesByQuery } from \"./js/pixabay-api\";\nimport { clearGallery, createGallery, hideLoader, hideLoadMoreButton, showLoader, showLoadMoreButton } from \"./js/render-functions\";\n\nexport const refs = {\n    form: document.querySelector('.form'),\n    galleryList: document.querySelector('.gallery'),\n    loader: document.querySelector('.loader'),\n    showMoreBtn: document.querySelector('.show-more'),\n};\n\nexport const perPage = 15;\nlet totalPages = 0;\nlet page = 1;\nlet query = '';\n\nrefs.form.addEventListener('submit', async (e) => {\n    e.preventDefault();\n\n    const formData = new FormData(e.target);\n    query = formData.get('search-text').trim();\n\n     if (!query) {\n        iziToast.warning({\n            message: \"Please enter a search query before submitting!\",\n        });\n        return;\n    }\n\n    page = 1;\n\n    hideLoadMoreButton();\n    showLoader();\n    clearGallery();\n\n    try {\n        const data = await getImagesByQuery(query, page);\n\n        const totalHits = data.totalHits;\n        totalPages = Math.ceil(totalHits / perPage);\n   \n        if (data.hits.length === 0) {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n            });\n            return;\n        }\n        createGallery(data.hits);\n        if (page < totalPages) {\n            showLoadMoreButton();\n        }\n\n    } catch(error) {\n        console.error(error);\n        iziToast.error({\n            message: \"Something went wrong. Please try again later.\",\n        });\n    } finally {\n        hideLoader(); \n  }\n});\n\nrefs.showMoreBtn.addEventListener('click', async e => {\n    page += 1;\n\n    if (page > totalPages) {\n        iziToast.info({\n            message: `We're sorry, but you've reached the end of search results`,\n        })\n        hideLoadMoreButton();\n        return;\n    }\n\n    showLoader();\n    hideLoadMoreButton();\n\n    try {\n        const data = await getImagesByQuery(query, page);\n\n        const totalHits = data.totalHits;\n        totalPages = Math.ceil(totalHits / perPage);\n   \n        if (data.hits.length === 0) {\n            iziToast.error({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n            });\n            hideLoader();\n            refs.form.reset();\n            return;\n        }\n\n        createGallery(data.hits);\n\n        const firstCard = refs.galleryList.querySelector('li');\n        if (firstCard) {\n            const cardRect = firstCard.getBoundingClientRect();\n            window.scrollBy({\n                top: cardRect.height * 2, \n                behavior: 'smooth',\n            });\n        }\n        \n        if (page < totalPages) {\n            showLoadMoreButton();\n        } else {\n            hideLoadMoreButton();\n            iziToast.info({\n                message: \"You've reached the end of search results.\",\n            });\n        }\n\n    } catch (error) {\n        console.error(error);\n        iziToast.error({\n            message: \"Something went wrong. Please try again later.\",\n        });\n    } finally {\n        hideLoader();\n    }\n\n})"],"names":["BASE_URL","API_KEY","getImagesByQuery","query","page","axios","perPage","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","refs","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","totalPages","e","iziToast","data","totalHits","error","firstCard","cardRect"],"mappings":"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"}